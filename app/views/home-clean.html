<!-- BookStore Homepage - Cleaned -->
<div class="bookstore-homepage">
    <!-- S√°ch b√°n ch·∫°y -->
    <section class="bestsellers-section py-5">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h2 class="section-title">üìö S√°ch b√°n ch·∫°y</h2>
                    <p class="section-subtitle">Nh·ªØng cu·ªën s√°ch ƒë∆∞·ª£c ƒë·ªôc gi·∫£ y√™u th√≠ch nh·∫•t</p>
                </div>
            </div>
            
            <div class="row g-4" ng-if="!loading">
                <div class="col-lg-3 col-md-4 col-sm-6" ng-repeat="book in bestSellers | limitTo:8">
                    <div class="book-card h-100" 
                         data-bs-toggle="tooltip" 
                         ng-attr-title="{{book.title}}&#10;Gi√°: {{book.unitPrice | currency:'':0}} VNƒê&#10;ƒê√°nh gi√°: {{book.rating || 'N/A'}}‚≠ê&#10;B√°n ƒë∆∞·ª£c: {{book.totalSold}} cu·ªën&#10;{{(book.discountPercent) ? 'Khuy·∫øn m√£i: ' + book.discountPercent + '% OFF' : ''}}">
                        
                        <div class="book-image">
                            <img ng-src="{{book.imageUrl || 'app/assets/images/book-placeholder.png'}}" 
                                 alt="{{book.title}}"
                                 onerror="this.src='app/assets/images/book-placeholder.png'">
                            
                            <div class="book-badge" ng-if="hasPromo(book)">
                                <span class="badge bg-danger">{{calculateDiscountPercent(book)}}% OFF</span>
                            </div>
                        </div>
                        
                        <div class="book-info">
                            <h6 class="book-title">{{book.title}}</h6>
                            
                            <!-- Rating -->
                            <div class="book-rating mb-2">
                                <span class="rating-stars">
                                    <i class="bi bi-star-fill" ng-repeat="star in getStarArray(book.rating)" style="color: #ffc107;"></i>
                                    <i class="bi bi-star" ng-repeat="star in getEmptyStarArray(book.rating)" style="color: #e9ecef;"></i>
                                </span>
                                <span class="rating-text ms-1">{{book.rating || 'Ch∆∞a ƒë√°nh gi√°'}}</span>
                                <small class="text-muted ms-2">({{book.totalReviews || 0}})</small>
                            </div>
                            
                            <!-- Price -->
                            <div class="price-row" ng-if="hasPromo(book)">
                                <span class="price-new">{{getFinalPrice(book) | currency:'':0}} VNƒê</span>
                                <span class="price-old">{{book.unitPrice | currency:'':0}} VNƒê</span>
                                <span class="discount-badge">{{calculateDiscountPercent(book)}}% OFF</span>
                            </div>
                            <p class="book-price" ng-if="!hasPromo(book)">{{book.unitPrice | currency:'':0}} VNƒê</p>
                            
                            <!-- Stats -->
                            <div class="book-stats">
                                <small class="text-muted">
                                    <i class="bi bi-graph-up me-1"></i>{{book.totalSold}} cu·ªën ƒë√£ b√°n
                                </small>
                            </div>
                            
                            <!-- Actions -->
                            <div class="mt-2">
                                <button class="btn btn-sm btn-primary" ng-click="addToCart(book)">
                                    <i class="bi bi-cart-plus me-1"></i>Th√™m v√†o gi·ªè
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Loading State -->
            <div class="row g-4" ng-if="loading">
                <div class="col-lg-3 col-md-4 col-sm-6" ng-repeat="n in [1,2,3,4,5,6,7,8]">
                    <div class="book-placeholder h-100">
                        <div class="placeholder-image"></div>
                        <div class="placeholder-content">
                            <div class="placeholder-title"></div>
                            <div class="placeholder-price"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empty State -->
            <div class="row" ng-if="!loading && bestSellers.length === 0">
                <div class="col-12 text-center">
                    <div class="empty-state">
                        <i class="bi bi-book empty-icon"></i>
                        <h4>Ch∆∞a c√≥ s√°ch b√°n ch·∫°y</h4>
                        <p>H√£y quay l·∫°i sau ƒë·ªÉ xem nh·ªØng cu·ªën s√°ch n·ªïi b·∫≠t!</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- S√°ch m·ªõi -->
    <section class="new-books-section py-5">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h2 class="section-title">üÜï S√°ch m·ªõi</h2>
                    <p class="section-subtitle">Nh·ªØng ƒë·∫ßu s√°ch m·ªõi nh·∫•t v·ª´a ƒë∆∞·ª£c c·∫≠p nh·∫≠t</p>
                </div>
            </div>
            
            <div class="row g-4" ng-if="!loading">
                <div class="col-lg-3 col-md-4 col-sm-6" ng-repeat="book in newBooks | limitTo:8">
                    <div class="book-card h-100" 
                         data-bs-toggle="tooltip" 
                         ng-attr-title="{{book.title}}&#10;Gi√°: {{book.unitPrice | currency:'':0}} VNƒê&#10;ƒê√°nh gi√°: {{book.rating || 'N/A'}}‚≠ê&#10;B√°n ƒë∆∞·ª£c: {{book.totalSold}} cu·ªën&#10;{{(book.discountPercent) ? 'Khuy·∫øn m√£i: ' + book.discountPercent + '% OFF' : ''}}">
                        
                        <div class="book-image">
                            <img ng-src="{{book.imageUrl || 'app/assets/images/book-placeholder.png'}}" 
                                 alt="{{book.title}}"
                                 onerror="this.src='app/assets/images/book-placeholder.png'">
                            
                            <div class="book-badge" ng-if="hasPromo(book)">
                                <span class="badge bg-danger">{{calculateDiscountPercent(book)}}% OFF</span>
                            </div>
                        </div>
                        
                        <div class="book-info">
                            <h6 class="book-title">{{book.title}}</h6>
                            
                            <!-- Rating -->
                            <div class="book-rating mb-2">
                                <span class="rating-stars">
                                    <i class="bi bi-star-fill" ng-repeat="star in getStarArray(book.rating)" style="color: #ffc107;"></i>
                                    <i class="bi bi-star" ng-repeat="star in getEmptyStarArray(book.rating)" style="color: #e9ecef;"></i>
                                </span>
                                <span class="rating-text ms-1">{{book.rating || 'Ch∆∞a ƒë√°nh gi√°'}}</span>
                                <small class="text-muted ms-2">({{book.totalReviews || 0}})</small>
                            </div>
                            
                            <!-- Price -->
                            <div class="price-row" ng-if="hasPromo(book)">
                                <span class="price-new">{{getFinalPrice(book) | currency:'':0}} VNƒê</span>
                                <span class="price-old">{{book.unitPrice | currency:'':0}} VNƒê</span>
                                <span class="discount-badge">{{calculateDiscountPercent(book)}}% OFF</span>
                            </div>
                            <p class="book-price" ng-if="!hasPromo(book)">{{book.unitPrice | currency:'':0}} VNƒê</p>
                            
                            <!-- Stats -->
                            <div class="book-stats">
                                <small class="text-muted">
                                    <i class="bi bi-graph-up me-1"></i>{{book.totalSold}} cu·ªën ƒë√£ b√°n
                                </small>
                            </div>
                            
                            <!-- Actions -->
                            <div class="mt-2">
                                <button class="btn btn-sm btn-primary" ng-click="addToCart(book)">
                                    <i class="bi bi-cart-plus me-1"></i>Th√™m v√†o gi·ªè
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Loading State -->
            <div class="row g-4" ng-if="loading">
                <div class="col-lg-3 col-md-4 col-sm-6" ng-repeat="n in [1,2,3,4,5,6,7,8]">
                    <div class="book-placeholder h-100">
                        <div class="placeholder-image"></div>
                        <div class="placeholder-content">
                            <div class="placeholder-title"></div>
                            <div class="placeholder-price"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empty State -->
            <div class="row" ng-if="!loading && newBooks.length === 0">
                <div class="col-12 text-center">
                    <div class="empty-state">
                        <i class="bi bi-book empty-icon"></i>
                        <h4>Ch∆∞a c√≥ s√°ch m·ªõi</h>
                        <p>Ch√∫ng t√¥i s·∫Ω s·ªõm c·∫≠p nh·∫≠t nh·ªØng ƒë·∫ßu s√°ch m·ªõi!</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
